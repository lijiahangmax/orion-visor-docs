var ee=Object.create;var q=Object.defineProperty;var te=Object.getOwnPropertyDescriptor;var ne=Object.getOwnPropertyNames;var ie=Object.getPrototypeOf,re=Object.prototype.hasOwnProperty;var j=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var oe=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of ne(t))!re.call(e,r)&&r!==n&&q(e,r,{get:()=>t[r],enumerable:!(i=te(t,r))||i.enumerable});return e};var se=(e,t,n)=>(n=e!=null?ee(ie(e)):{},oe(t||!e||!e.__esModule?q(n,"default",{value:e,enumerable:!0}):n,e));var R=j(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});T.shellExpand=T.ensureTrailingSlash=void 0;var ae=e=>e.endsWith("/")?e:`${e}/`;T.ensureTrailingSlash=ae;var ue=(e,t)=>e.startsWith("~")&&(e.length===1||e.charAt(1)==="/")?e.replace("~",t):e,le=(e,t)=>e.replace(/\$([A-Za-z0-9_]+)/g,r=>{var o;let a=r.slice(1);return(o=t[a])!==null&&o!==void 0?o:r}).replace(/\$\{([A-Za-z0-9_]+)(?::-([^}]+))?\}/g,(r,o,a)=>{var l,c;return(c=(l=t[o])!==null&&l!==void 0?l:a)!==null&&c!==void 0?c:r}),ce=(e,t)=>{var n;let{environmentVariables:i}=t;return le(ue(e,(n=i?.HOME)!==null&&n!==void 0?n:"~"),i)};T.shellExpand=ce});var $=j(v=>{"use strict";var fe=v&&v.__awaiter||function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(s){try{u(i.next(s))}catch(f){a(f)}}function c(s){try{u(i.throw(s))}catch(f){a(f)}}function u(s){s.done?o(s.value):r(s.value).then(l,c)}u((i=i.apply(e,t||[])).next())})};Object.defineProperty(v,"__esModule",{value:!0});v.filepaths=v.folders=v.getCurrentInsertedDirectory=v.sortFilesAlphabetically=void 0;var C=R();function J(e,t=[]){let n=t.map(r=>r.toLowerCase()),i=e.filter(r=>!n.includes(r.toLowerCase()));return[...i.filter(r=>!r.startsWith(".")).sort((r,o)=>r.localeCompare(o)),...i.filter(r=>r.startsWith(".")).sort((r,o)=>r.localeCompare(o)),"../"]}v.sortFilesAlphabetically=J;var de=(e,t,n)=>{if(e===null)return"/";let i=(0,C.shellExpand)(t,n),r=i.slice(0,i.lastIndexOf("/")+1);return r===""?(0,C.ensureTrailingSlash)(e):r.startsWith("/")?r:`${(0,C.ensureTrailingSlash)(e)}${r}`};v.getCurrentInsertedDirectory=de;function L(e={}){let{extensions:t=[],equals:n=[],matches:i,filterFolders:r=!1,editFileSuggestions:o,editFolderSuggestions:a,rootDirectory:l,showFolders:c="always"}=e,u=new Set(t),s=new Set(n),f=()=>t.length>0||n.length>0||i,g=(p=[])=>f()?p.filter(({name:m="",type:_})=>{if(!r&&_==="folder"||s.has(m)||i&&m.match(i))return!0;let[,...d]=m.split(".");if(d.length>=1){let b=d.length-1,O=d[b];do{if(u.has(O))return!0;b-=1,O=[d[b],O].join(".")}while(b>=0)}return!1}):p,S=(p=[])=>!o&&!a?p:p.map(m=>Object.assign(Object.assign({},m),(m.type==="file"?o:a)||{}));return{trigger:(p,m)=>{let _=p.lastIndexOf("/"),d=m.lastIndexOf("/");return _!==d?!0:_===-1&&d===-1?!1:p.slice(0,_)!==m.slice(0,d)},getQueryTerm:p=>p.slice(p.lastIndexOf("/")+1),custom:(p,m,_)=>fe(this,void 0,void 0,function*(){var d;let{isDangerous:b,currentWorkingDirectory:O,searchTerm:h}=_,w=(d=(0,v.getCurrentInsertedDirectory)(l??O,h,_))!==null&&d!==void 0?d:"/";try{let N=yield m({command:"ls",args:["-1ApL"],cwd:w}),Y=J(N.stdout.split(`
`),[".DS_Store"]),W=[];for(let V of Y)if(V){let F=V.endsWith("/")?"folders":"filepaths";(F==="filepaths"&&c!=="only"||F==="folders"&&c!=="never")&&W.push({type:F==="filepaths"?"file":"folder",name:V,insertValue:V,isDangerous:b,context:{templateType:F}})}return S(g(W))}catch{return[]}})}}v.folders=Object.assign(()=>L({showFolders:"only"}),Object.freeze(L({showFolders:"only"})));v.filepaths=Object.assign(L,Object.freeze(L()))});var H=j(x=>{"use strict";var A=x&&x.__awaiter||function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(s){try{u(i.next(s))}catch(f){a(f)}}function c(s){try{u(i.throw(s))}catch(f){a(f)}}function u(s){s.done?o(s.value):r(s.value).then(l,c)}u((i=i.apply(e,t||[])).next())})};Object.defineProperty(x,"__esModule",{value:!0});x.keyValueList=x.keyValue=x.valueList=void 0;var K=new Map;function D(e,t){return e.length===0?t:t.map(n=>n.insertValue?n:Object.assign(Object.assign({},n),{insertValue:n.name+e}))}function k(e,t,n){return A(this,void 0,void 0,function*(){if(typeof e=="function"){let i=yield e(...n);return D(t,i)}if(typeof e[0]=="string"){let i=e.map(r=>({name:r}));return D(t,i)}return D(t,e)})}function E(e,t,n,i){return A(this,void 0,void 0,function*(){if(n||Array.isArray(e)){let r=K.get(e);return r===void 0&&(r=yield k(e,t,i),K.set(e,r)),r}return k(e,t,i)})}function z(e,t){return typeof t=="string"?e&&t==="keys"||!e&&t==="values":t}function M(e,...t){return Math.max(...t.map(n=>e.lastIndexOf(n)))}function P(e,t){let n=new Set(e);return t.filter(i=>{var r;return typeof i.name=="string"?!n.has(i.name):!(!((r=i.name)===null||r===void 0)&&r.some(o=>n.has(o)))})}function pe({delimiter:e=",",values:t=[],cache:n=!1,insertDelimiter:i=!1,allowRepeatedValues:r=!1}){return{trigger:(o,a)=>o.lastIndexOf(e)!==a.lastIndexOf(e),getQueryTerm:o=>o.slice(o.lastIndexOf(e)+e.length),custom:(...o)=>A(this,void 0,void 0,function*(){var a;let l=yield E(t,i?e:"",n,o);if(r)return l;let[c]=o,u=(a=c[c.length-1])===null||a===void 0?void 0:a.split(e);return P(u,l)})}}x.valueList=pe;function he({separator:e="=",keys:t=[],values:n=[],cache:i=!1,insertSeparator:r=!0}){return{trigger:(o,a)=>o.indexOf(e)!==a.indexOf(e),getQueryTerm:o=>o.slice(o.indexOf(e)+1),custom:(...o)=>A(this,void 0,void 0,function*(){let[a]=o,c=!a[a.length-1].includes(e),u=c?t:n,s=z(c,i);return E(u,c&&r?e:"",s,o)})}}x.keyValue=he;function me({separator:e="=",delimiter:t=",",keys:n=[],values:i=[],cache:r=!1,insertSeparator:o=!0,insertDelimiter:a=!1,allowRepeatedKeys:l=!1,allowRepeatedValues:c=!0}){return{trigger:(u,s)=>{let f=M(u,e,t),g=M(s,e,t);return f!==g},getQueryTerm:u=>{let s=M(u,e,t);return u.slice(s+1)},custom:(...u)=>A(this,void 0,void 0,function*(){let[s]=u,f=s[s.length-1],g=M(f,e,t),S=g===-1||f.slice(g,g+e.length)!==e,p=S?n:i,m=z(S,r),d=yield E(p,S?o?e:"":a?t:"",m,u);if(S){if(l)return d;let O=f.split(t).map(h=>h.slice(0,h.indexOf(e)));return P(O,d)}if(c)return d;let b=f.split(t).map(O=>O.slice(O.indexOf(e)+e.length));return P(b,d)})}}x.keyValueList=me});var Q=j(I=>{"use strict";var ge=I&&I.__awaiter||function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(s){try{u(i.next(s))}catch(f){a(f)}}function c(s){try{u(i.throw(s))}catch(f){a(f)}}function u(s){s.done?o(s.value):r(s.value).then(l,c)}u((i=i.apply(e,t||[])).next())})};Object.defineProperty(I,"__esModule",{value:!0});I.ai=void 0;var ve=4097,ye=4,be=.8,_e=ve*ye*be;function Oe({name:e,prompt:t,message:n,postProcess:i,temperature:r,splitOn:o}){return{scriptTimeout:15e3,custom:(a,l,c)=>ge(this,void 0,void 0,function*(){var u,s;let f=yield l({command:"fig",args:["settings","--format","json","autocomplete.ai.enabled"]});if(!JSON.parse(f.stdout))return[];let g=typeof t=="function"?yield t({tokens:a,executeCommand:l,generatorContext:c}):t,S=typeof n=="function"?yield n({tokens:a,executeCommand:l,generatorContext:c}):n;if(S===null||S.length===0)return console.warn("No message provided to AI generator"),[];let p=_e-((u=g?.length)!==null&&u!==void 0?u:0),m={model:"gpt-3.5-turbo",source:"autocomplete",name:e,messages:[...g?[{role:"system",content:g}]:[],{role:"user",content:S.slice(0,p)}],temperature:r},_=JSON.stringify(m),d=yield l({command:"fig",args:["_","request","--route","/ai/chat","--method","POST","--body",_]}),b=JSON.parse(d.stdout);return(s=b?.choices.map(h=>{var w;return(w=h?.message)===null||w===void 0?void 0:w.content}).filter(h=>typeof h=="string").flatMap(h=>o?h.split(o).filter(w=>w.trim().length>0):[h]).map(h=>{if(i)return i(h);let w=h.trim().replace(/\n/g," ");return{icon:"\u{1FA84}",name:w,insertValue:`'${w}'`,description:"Generated by Fig AI"}}))!==null&&s!==void 0?s:[]})}}I.ai=Oe});var B=j(y=>{"use strict";var Se=y&&y.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),we=y&&y.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&Se(t,e,n)};Object.defineProperty(y,"__esModule",{value:!0});y.ai=y.folders=y.filepaths=void 0;var X=$();Object.defineProperty(y,"filepaths",{enumerable:!0,get:function(){return X.filepaths}});Object.defineProperty(y,"folders",{enumerable:!0,get:function(){return X.folders}});we(H(),y);var xe=Q();Object.defineProperty(y,"ai",{enumerable:!0,get:function(){return xe.ai}})});var Z=se(B(),1),G={generators:{script:["shortcuts","list"],postProcess:e=>e.split(`
`).map(t=>({name:t,icon:"fig:///System/Applications/Shortcuts.app"}))}},U=[{name:"run",description:"Run a shortcut",icon:"\u25B6\uFE0F",args:{name:"shortcut-name",description:"The name of the shortcut to run",generators:G.generators},options:[{name:["-i","--input-path"],args:{name:"input-path",template:"filepaths"},description:"The input to provide to the shortcut"},{name:["-o","--output-path"],args:{name:"output-path",template:"filepaths"},description:"Where to write the shortcut output, if applicable"},{name:"--output-type",args:{name:"output-type",suggestions:[{name:"public.json",description:"JavaScript Object Notation (JSON)"},{name:"public.plain-text",description:"Plain text"},{name:"public.html",description:"HTML"},{name:"public.xml",description:"XML"},{name:"com.adobe.pdf",description:"Adobe PDF"},{name:"public.vcard",description:"VCard"}]},description:"What type to output data in, in Universal Type Identifier format"}]},{name:"list",description:"List your shortcuts",icon:"\u{1F4C2}",options:[{name:["--folder-name","-f"],description:"The name of the folder to list",args:{name:"folder-name",generators:{script:["shortcuts","list","--folders"],postProcess:e=>e.split(`
`).map(t=>({name:t,icon:"\u{1F4C2}"}))}}},{name:"--folders",description:"List folders instead of shortcuts",icon:"\u{1F4C2}"}]},{name:"view",description:"View a shortcut in Shortcuts",icon:"\u{1F50D}",args:{name:"shortcut-name",description:"The name of the shortcut to view",generators:G.generators}},{name:"sign",description:"Sign a shortcut file",icon:"\u{1F50F}",options:[{name:["--input","-i"],description:"The shortcut file to sign",args:{name:"input",generators:(0,Z.filepaths)({extensions:["shortcut"]})}},{name:["--output","-o"],description:"Output path for the signed shortcut file",args:{name:"output",template:"filepaths"}},{name:["--mode","-m"],description:"The signing mode. (default: people-who-know-me)",args:{name:"mode",suggestions:["people-who-know-me","anyone"]}}]}],Te={name:"shortcuts",description:"Command-line utility for running shortcuts",subcommands:[...U,{name:"help",description:"Show help information",subcommands:U.map(({name:e,description:t,icon:n})=>({name:e,description:t,icon:n}))}]},Me=Te;export{Me as default};

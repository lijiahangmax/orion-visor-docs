var se=Object.create;var G=Object.defineProperty;var re=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var ae=Object.getPrototypeOf,le=Object.prototype.hasOwnProperty;var L=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ce=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of oe(t))!le.call(e,s)&&s!==n&&G(e,s,{get:()=>t[s],enumerable:!(i=re(t,s))||i.enumerable});return e};var ue=(e,t,n)=>(n=e!=null?se(ae(e)):{},ce(t||!e||!e.__esModule?G(n,"default",{value:e,enumerable:!0}):n,e));var H=L(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.shellExpand=x.ensureTrailingSlash=void 0;var de=e=>e.endsWith("/")?e:`${e}/`;x.ensureTrailingSlash=de;var fe=(e,t)=>e.startsWith("~")&&(e.length===1||e.charAt(1)==="/")?e.replace("~",t):e,pe=(e,t)=>e.replace(/\$([A-Za-z0-9_]+)/g,s=>{var r;let a=s.slice(1);return(r=t[a])!==null&&r!==void 0?r:s}).replace(/\$\{([A-Za-z0-9_]+)(?::-([^}]+))?\}/g,(s,r,a)=>{var c,u;return(u=(c=t[r])!==null&&c!==void 0?c:a)!==null&&u!==void 0?u:s}),me=(e,t)=>{var n;let{environmentVariables:i}=t;return pe(fe(e,(n=i?.HOME)!==null&&n!==void 0?n:"~"),i)};x.shellExpand=me});var z=L(v=>{"use strict";var he=v&&v.__awaiter||function(e,t,n,i){function s(r){return r instanceof n?r:new n(function(a){a(r)})}return new(n||(n=Promise))(function(r,a){function c(o){try{l(i.next(o))}catch(d){a(d)}}function u(o){try{l(i.throw(o))}catch(d){a(d)}}function l(o){o.done?r(o.value):s(o.value).then(c,u)}l((i=i.apply(e,t||[])).next())})};Object.defineProperty(v,"__esModule",{value:!0});v.filepaths=v.folders=v.getCurrentInsertedDirectory=v.sortFilesAlphabetically=void 0;var V=H();function W(e,t=[]){let n=t.map(s=>s.toLowerCase()),i=e.filter(s=>!n.includes(s.toLowerCase()));return[...i.filter(s=>!s.startsWith(".")).sort((s,r)=>s.localeCompare(r)),...i.filter(s=>s.startsWith(".")).sort((s,r)=>s.localeCompare(r)),"../"]}v.sortFilesAlphabetically=W;var ge=(e,t,n)=>{if(e===null)return"/";let i=(0,V.shellExpand)(t,n),s=i.slice(0,i.lastIndexOf("/")+1);return s===""?(0,V.ensureTrailingSlash)(e):s.startsWith("/")?s:`${(0,V.ensureTrailingSlash)(e)}${s}`};v.getCurrentInsertedDirectory=ge;function E(e={}){let{extensions:t=[],equals:n=[],matches:i,filterFolders:s=!1,editFileSuggestions:r,editFolderSuggestions:a,rootDirectory:c,showFolders:u="always"}=e,l=new Set(t),o=new Set(n),d=()=>t.length>0||n.length>0||i,y=(p=[])=>d()?p.filter(({name:h="",type:S})=>{if(!s&&S==="folder"||o.has(h)||i&&h.match(i))return!0;let[,...f]=h.split(".");if(f.length>=1){let O=f.length-1,b=f[O];do{if(l.has(b))return!0;O-=1,b=[f[O],b].join(".")}while(O>=0)}return!1}):p,w=(p=[])=>!r&&!a?p:p.map(h=>Object.assign(Object.assign({},h),(h.type==="file"?r:a)||{}));return{trigger:(p,h)=>{let S=p.lastIndexOf("/"),f=h.lastIndexOf("/");return S!==f?!0:S===-1&&f===-1?!1:p.slice(0,S)!==h.slice(0,f)},getQueryTerm:p=>p.slice(p.lastIndexOf("/")+1),custom:(p,h,S)=>he(this,void 0,void 0,function*(){var f;let{isDangerous:O,currentWorkingDirectory:b,searchTerm:m}=S,I=(f=(0,v.getCurrentInsertedDirectory)(c??b,m,S))!==null&&f!==void 0?f:"/";try{let q=yield h({command:"ls",args:["-1ApL"],cwd:I}),ie=W(q.stdout.split(`
`),[".DS_Store"]),$=[];for(let D of ie)if(D){let j=D.endsWith("/")?"folders":"filepaths";(j==="filepaths"&&u!=="only"||j==="folders"&&u!=="never")&&$.push({type:j==="filepaths"?"file":"folder",name:D,insertValue:D,isDangerous:O,context:{templateType:j}})}return w(y($))}catch{return[]}})}}v.folders=Object.assign(()=>E({showFolders:"only"}),Object.freeze(E({showFolders:"only"})));v.filepaths=Object.assign(E,Object.freeze(E()))});var Q=L(T=>{"use strict";var C=T&&T.__awaiter||function(e,t,n,i){function s(r){return r instanceof n?r:new n(function(a){a(r)})}return new(n||(n=Promise))(function(r,a){function c(o){try{l(i.next(o))}catch(d){a(d)}}function u(o){try{l(i.throw(o))}catch(d){a(d)}}function l(o){o.done?r(o.value):s(o.value).then(c,u)}l((i=i.apply(e,t||[])).next())})};Object.defineProperty(T,"__esModule",{value:!0});T.keyValueList=T.keyValue=T.valueList=void 0;var J=new Map;function M(e,t){return e.length===0?t:t.map(n=>n.insertValue?n:Object.assign(Object.assign({},n),{insertValue:n.name+e}))}function K(e,t,n){return C(this,void 0,void 0,function*(){if(typeof e=="function"){let i=yield e(...n);return M(t,i)}if(typeof e[0]=="string"){let i=e.map(s=>({name:s}));return M(t,i)}return M(t,e)})}function R(e,t,n,i){return C(this,void 0,void 0,function*(){if(n||Array.isArray(e)){let s=J.get(e);return s===void 0&&(s=yield K(e,t,i),J.set(e,s)),s}return K(e,t,i)})}function U(e,t){return typeof t=="string"?e&&t==="keys"||!e&&t==="values":t}function N(e,...t){return Math.max(...t.map(n=>e.lastIndexOf(n)))}function P(e,t){let n=new Set(e);return t.filter(i=>{var s;return typeof i.name=="string"?!n.has(i.name):!(!((s=i.name)===null||s===void 0)&&s.some(r=>n.has(r)))})}function ye({delimiter:e=",",values:t=[],cache:n=!1,insertDelimiter:i=!1,allowRepeatedValues:s=!1}){return{trigger:(r,a)=>r.lastIndexOf(e)!==a.lastIndexOf(e),getQueryTerm:r=>r.slice(r.lastIndexOf(e)+e.length),custom:(...r)=>C(this,void 0,void 0,function*(){var a;let c=yield R(t,i?e:"",n,r);if(s)return c;let[u]=r,l=(a=u[u.length-1])===null||a===void 0?void 0:a.split(e);return P(l,c)})}}T.valueList=ye;function ve({separator:e="=",keys:t=[],values:n=[],cache:i=!1,insertSeparator:s=!0}){return{trigger:(r,a)=>r.indexOf(e)!==a.indexOf(e),getQueryTerm:r=>r.slice(r.indexOf(e)+1),custom:(...r)=>C(this,void 0,void 0,function*(){let[a]=r,u=!a[a.length-1].includes(e),l=u?t:n,o=U(u,i);return R(l,u&&s?e:"",o,r)})}}T.keyValue=ve;function _e({separator:e="=",delimiter:t=",",keys:n=[],values:i=[],cache:s=!1,insertSeparator:r=!0,insertDelimiter:a=!1,allowRepeatedKeys:c=!1,allowRepeatedValues:u=!0}){return{trigger:(l,o)=>{let d=N(l,e,t),y=N(o,e,t);return d!==y},getQueryTerm:l=>{let o=N(l,e,t);return l.slice(o+1)},custom:(...l)=>C(this,void 0,void 0,function*(){let[o]=l,d=o[o.length-1],y=N(d,e,t),w=y===-1||d.slice(y,y+e.length)!==e,p=w?n:i,h=U(w,s),f=yield R(p,w?r?e:"":a?t:"",h,l);if(w){if(c)return f;let b=d.split(t).map(m=>m.slice(0,m.indexOf(e)));return P(b,f)}if(u)return f;let O=d.split(t).map(b=>b.slice(b.indexOf(e)+e.length));return P(O,f)})}}T.keyValueList=_e});var B=L(F=>{"use strict";var Oe=F&&F.__awaiter||function(e,t,n,i){function s(r){return r instanceof n?r:new n(function(a){a(r)})}return new(n||(n=Promise))(function(r,a){function c(o){try{l(i.next(o))}catch(d){a(d)}}function u(o){try{l(i.throw(o))}catch(d){a(d)}}function l(o){o.done?r(o.value):s(o.value).then(c,u)}l((i=i.apply(e,t||[])).next())})};Object.defineProperty(F,"__esModule",{value:!0});F.ai=void 0;var Se=4097,be=4,we=.8,Ie=Se*be*we;function Te({name:e,prompt:t,message:n,postProcess:i,temperature:s,splitOn:r}){return{scriptTimeout:15e3,custom:(a,c,u)=>Oe(this,void 0,void 0,function*(){var l,o;let d=yield c({command:"fig",args:["settings","--format","json","autocomplete.ai.enabled"]});if(!JSON.parse(d.stdout))return[];let y=typeof t=="function"?yield t({tokens:a,executeCommand:c,generatorContext:u}):t,w=typeof n=="function"?yield n({tokens:a,executeCommand:c,generatorContext:u}):n;if(w===null||w.length===0)return console.warn("No message provided to AI generator"),[];let p=Ie-((l=y?.length)!==null&&l!==void 0?l:0),h={model:"gpt-3.5-turbo",source:"autocomplete",name:e,messages:[...y?[{role:"system",content:y}]:[],{role:"user",content:w.slice(0,p)}],temperature:s},S=JSON.stringify(h),f=yield c({command:"fig",args:["_","request","--route","/ai/chat","--method","POST","--body",S]}),O=JSON.parse(f.stdout);return(o=O?.choices.map(m=>{var I;return(I=m?.message)===null||I===void 0?void 0:I.content}).filter(m=>typeof m=="string").flatMap(m=>r?m.split(r).filter(I=>I.trim().length>0):[m]).map(m=>{if(i)return i(m);let I=m.trim().replace(/\n/g," ");return{icon:"\u{1FA84}",name:I,insertValue:`'${I}'`,description:"Generated by Fig AI"}}))!==null&&o!==void 0?o:[]})}}F.ai=Te});var Y=L(_=>{"use strict";var Ae=_&&_.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),xe=_&&_.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&Ae(t,e,n)};Object.defineProperty(_,"__esModule",{value:!0});_.ai=_.folders=_.filepaths=void 0;var X=z();Object.defineProperty(_,"filepaths",{enumerable:!0,get:function(){return X.filepaths}});Object.defineProperty(_,"folders",{enumerable:!0,get:function(){return X.folders}});xe(Q(),_);var Fe=B();Object.defineProperty(_,"ai",{enumerable:!0,get:function(){return Fe.ai}})});var te=ue(Y(),1),ne=76,g=e=>[{name:["-h","--help"],description:`Help for ${e}`},{name:"--debug",description:"Debug mode"}],A=e=>({script:["limactl","list","--quiet"],postProcess:t=>t.split(`
`).map(n=>({name:`${n}`,description:"Instance name",priority:ne,...e}))}),Z=(0,te.filepaths)({extensions:["yaml","yml"],editFileSuggestions:{priority:ne}}),k={name:"limactl",description:"Control the Lima(Linux virtual machines)",subcommands:[{name:"completion",description:"Generate the autocompletion script for the specified shell",subcommands:["bash","fish","powershell","zsh"].map(e=>({name:e,description:`Generate the autocompletion script for ${e}`,options:[...g(e),{name:"--no-descriptions",description:"Disable completion descriptions"}]})),options:[...g("completion")]},{name:["copy","cp"],description:"Copy files between host and guest",args:[{name:"SOURCE",isVariadic:!0,generators:[A({isDangerous:!0}),{template:"filepaths"}]},{name:"TARGET",generators:[A(),{template:"filepaths"}]}],options:[...g("copy"),{name:["-r","--recursive"],description:"Copy directories recursively"}]},{name:["delete","remove","rm"],description:"Delete an instance of Lima",args:{name:"INSTANCE",isVariadic:!0,generators:A({isDangerous:!0})},options:[...g("delete"),{name:["-f","--force"],description:"Forcibly kill the processes",isDangerous:!0}]},{name:"info",description:"Show diagnostic information",options:[...g("info")]},{name:["list","ls"],description:"List instances of Lima",options:[...g("list"),{name:"--json",description:"JSONify output"},{name:["-q","--quiet"],description:"Only show names"}]},{name:"prune",description:"Prune garbage objects",isDangerous:!0,options:[...g("prune")]},{name:"shell",description:'Lima command is provided as an alias for limactl shell $LIMA_INSTANCE. $LIMA_INSTANCE defaults to "default"',args:[{name:"INSTANCE",generators:A({isDangerous:!0})},{name:"COMMAND",isVariadic:!0,isOptional:!0,isCommand:!0}],options:[...g("shell"),{name:"--workdir",description:"Working directory",args:{name:"string"}}]},{name:"show-ssh",description:"Show the ssh command line",args:{name:"INSTANCE",generators:A()},options:[...g("show-ssh"),{name:["-f","--format"],description:'Format: cmd, args, options, config (default "cmd")',args:{name:"string",default:"cmd",suggestions:[{name:"cmd",description:"Full ssh command line"},{name:"args",description:'Similar to the cmd format but omits "ssh" and the destination address'},{name:"options",description:"Ssh option key value pairs"},{name:"config",description:"~/.ssh/config format"}]}}]},{name:"start",description:'Start an instance of Lima. If the instance does not exist, open an editor for creating new one, with name "default"',args:{name:"NAME|FILE.yaml|URL",generators:[A(),Z]},options:[...g("start"),{name:"--tty",description:"Enable TUI interactions such as opening an editor, defaults to true when stdout is a terminal (default true)"}]},{name:"stop",description:"Stop an instance",isDangerous:!0,args:{name:"INSTANCE",generators:A({isDangerous:!0})},options:[...g("stop"),{name:["-f","--force"],description:"Force stop the instance",isDangerous:!0}]},{name:"sudoers",description:"Generate /etc/sudoers.d/lima file for enabling vmnet.framework support. See /usr/local/share/doc/lima/docs/network.md for the usage",args:{name:"SUDORSFILE",isOptional:!0,template:"filepaths"},options:[...g("sudoers"),{name:"--check",description:'Check that the sudoers file is up-to-date with "~/.lima/_config/networks.yaml"'}]},{name:"validate",description:"Validate YAML files",args:{name:"FILE.yaml",isVariadic:!0,generators:Z},options:[...g("validate")]}],options:[...g("limactl"),{name:["-v","--version"],description:"Version for limactl"}]},ee="Help provides help for any command in the application";k.subcommands.push({name:"help",description:ee,args:{name:"command",isOptional:!0,suggestions:[...k.subcommands.map(e=>({name:e.name,description:e.description,type:"subcommand"})),{name:"help",description:ee,type:"subcommand"}]}});var Ve=k;export{Ve as default};

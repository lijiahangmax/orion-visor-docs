var Z=Object.create;var N=Object.defineProperty;var Y=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.getPrototypeOf,ne=Object.prototype.hasOwnProperty;var T=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ie=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of ee(t))!ne.call(e,r)&&r!==n&&N(e,r,{get:()=>t[r],enumerable:!(i=Y(t,r))||i.enumerable});return e};var re=(e,t,n)=>(n=e!=null?Z(te(e)):{},ie(t||!e||!e.__esModule?N(n,"default",{value:e,enumerable:!0}):n,e));var k=T(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.shellExpand=j.ensureTrailingSlash=void 0;var se=e=>e.endsWith("/")?e:`${e}/`;j.ensureTrailingSlash=se;var oe=(e,t)=>e.startsWith("~")&&(e.length===1||e.charAt(1)==="/")?e.replace("~",t):e,ae=(e,t)=>e.replace(/\$([A-Za-z0-9_]+)/g,r=>{var s;let a=r.slice(1);return(s=t[a])!==null&&s!==void 0?s:r}).replace(/\$\{([A-Za-z0-9_]+)(?::-([^}]+))?\}/g,(r,s,a)=>{var c,u;return(u=(c=t[s])!==null&&c!==void 0?c:a)!==null&&u!==void 0?u:r}),le=(e,t)=>{var n;let{environmentVariables:i}=t;return ae(oe(e,(n=i?.HOME)!==null&&n!==void 0?n:"~"),i)};j.shellExpand=le});var $=T(y=>{"use strict";var ce=y&&y.__awaiter||function(e,t,n,i){function r(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(o){try{l(i.next(o))}catch(f){a(f)}}function u(o){try{l(i.throw(o))}catch(f){a(f)}}function l(o){o.done?s(o.value):r(o.value).then(c,u)}l((i=i.apply(e,t||[])).next())})};Object.defineProperty(y,"__esModule",{value:!0});y.filepaths=y.folders=y.getCurrentInsertedDirectory=y.sortFilesAlphabetically=void 0;var L=k();function W(e,t=[]){let n=t.map(r=>r.toLowerCase()),i=e.filter(r=>!n.includes(r.toLowerCase()));return[...i.filter(r=>!r.startsWith(".")).sort((r,s)=>r.localeCompare(s)),...i.filter(r=>r.startsWith(".")).sort((r,s)=>r.localeCompare(s)),"../"]}y.sortFilesAlphabetically=W;var ue=(e,t,n)=>{if(e===null)return"/";let i=(0,L.shellExpand)(t,n),r=i.slice(0,i.lastIndexOf("/")+1);return r===""?(0,L.ensureTrailingSlash)(e):r.startsWith("/")?r:`${(0,L.ensureTrailingSlash)(e)}${r}`};y.getCurrentInsertedDirectory=ue;function D(e={}){let{extensions:t=[],equals:n=[],matches:i,filterFolders:r=!1,editFileSuggestions:s,editFolderSuggestions:a,rootDirectory:c,showFolders:u="always"}=e,l=new Set(t),o=new Set(n),f=()=>t.length>0||n.length>0||i,g=(p=[])=>f()?p.filter(({name:v="",type:b})=>{if(!r&&b==="folder"||o.has(v)||i&&v.match(i))return!0;let[,...d]=v.split(".");if(d.length>=1){let _=d.length-1,O=d[_];do{if(l.has(O))return!0;_-=1,O=[d[_],O].join(".")}while(_>=0)}return!1}):p,S=(p=[])=>!s&&!a?p:p.map(v=>Object.assign(Object.assign({},v),(v.type==="file"?s:a)||{}));return{trigger:(p,v)=>{let b=p.lastIndexOf("/"),d=v.lastIndexOf("/");return b!==d?!0:b===-1&&d===-1?!1:p.slice(0,b)!==v.slice(0,d)},getQueryTerm:p=>p.slice(p.lastIndexOf("/")+1),custom:(p,v,b)=>ce(this,void 0,void 0,function*(){var d;let{isDangerous:_,currentWorkingDirectory:O,searchTerm:h}=b,w=(d=(0,y.getCurrentInsertedDirectory)(c??O,h,b))!==null&&d!==void 0?d:"/";try{let E=yield v({command:"ls",args:["-1ApL"],cwd:w}),X=W(E.stdout.split(`
`),[".DS_Store"]),P=[];for(let V of X)if(V){let F=V.endsWith("/")?"folders":"filepaths";(F==="filepaths"&&u!=="only"||F==="folders"&&u!=="never")&&P.push({type:F==="filepaths"?"file":"folder",name:V,insertValue:V,isDangerous:_,context:{templateType:F}})}return S(g(P))}catch{return[]}})}}y.folders=Object.assign(()=>D({showFolders:"only"}),Object.freeze(D({showFolders:"only"})));y.filepaths=Object.assign(D,Object.freeze(D()))});var Q=T(x=>{"use strict";var A=x&&x.__awaiter||function(e,t,n,i){function r(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(o){try{l(i.next(o))}catch(f){a(f)}}function u(o){try{l(i.throw(o))}catch(f){a(f)}}function l(o){o.done?s(o.value):r(o.value).then(c,u)}l((i=i.apply(e,t||[])).next())})};Object.defineProperty(x,"__esModule",{value:!0});x.keyValueList=x.keyValue=x.valueList=void 0;var K=new Map;function C(e,t){return e.length===0?t:t.map(n=>n.insertValue?n:Object.assign(Object.assign({},n),{insertValue:n.name+e}))}function z(e,t,n){return A(this,void 0,void 0,function*(){if(typeof e=="function"){let i=yield e(...n);return C(t,i)}if(typeof e[0]=="string"){let i=e.map(r=>({name:r}));return C(t,i)}return C(t,e)})}function q(e,t,n,i){return A(this,void 0,void 0,function*(){if(n||Array.isArray(e)){let r=K.get(e);return r===void 0&&(r=yield z(e,t,i),K.set(e,r)),r}return z(e,t,i)})}function J(e,t){return typeof t=="string"?e&&t==="keys"||!e&&t==="values":t}function R(e,...t){return Math.max(...t.map(n=>e.lastIndexOf(n)))}function M(e,t){let n=new Set(e);return t.filter(i=>{var r;return typeof i.name=="string"?!n.has(i.name):!(!((r=i.name)===null||r===void 0)&&r.some(s=>n.has(s)))})}function fe({delimiter:e=",",values:t=[],cache:n=!1,insertDelimiter:i=!1,allowRepeatedValues:r=!1}){return{trigger:(s,a)=>s.lastIndexOf(e)!==a.lastIndexOf(e),getQueryTerm:s=>s.slice(s.lastIndexOf(e)+e.length),custom:(...s)=>A(this,void 0,void 0,function*(){var a;let c=yield q(t,i?e:"",n,s);if(r)return c;let[u]=s,l=(a=u[u.length-1])===null||a===void 0?void 0:a.split(e);return M(l,c)})}}x.valueList=fe;function de({separator:e="=",keys:t=[],values:n=[],cache:i=!1,insertSeparator:r=!0}){return{trigger:(s,a)=>s.indexOf(e)!==a.indexOf(e),getQueryTerm:s=>s.slice(s.indexOf(e)+1),custom:(...s)=>A(this,void 0,void 0,function*(){let[a]=s,u=!a[a.length-1].includes(e),l=u?t:n,o=J(u,i);return q(l,u&&r?e:"",o,s)})}}x.keyValue=de;function pe({separator:e="=",delimiter:t=",",keys:n=[],values:i=[],cache:r=!1,insertSeparator:s=!0,insertDelimiter:a=!1,allowRepeatedKeys:c=!1,allowRepeatedValues:u=!0}){return{trigger:(l,o)=>{let f=R(l,e,t),g=R(o,e,t);return f!==g},getQueryTerm:l=>{let o=R(l,e,t);return l.slice(o+1)},custom:(...l)=>A(this,void 0,void 0,function*(){let[o]=l,f=o[o.length-1],g=R(f,e,t),S=g===-1||f.slice(g,g+e.length)!==e,p=S?n:i,v=J(S,r),d=yield q(p,S?s?e:"":a?t:"",v,l);if(S){if(c)return d;let O=f.split(t).map(h=>h.slice(0,h.indexOf(e)));return M(O,d)}if(u)return d;let _=f.split(t).map(O=>O.slice(O.indexOf(e)+e.length));return M(_,d)})}}x.keyValueList=pe});var H=T(I=>{"use strict";var he=I&&I.__awaiter||function(e,t,n,i){function r(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(o){try{l(i.next(o))}catch(f){a(f)}}function u(o){try{l(i.throw(o))}catch(f){a(f)}}function l(o){o.done?s(o.value):r(o.value).then(c,u)}l((i=i.apply(e,t||[])).next())})};Object.defineProperty(I,"__esModule",{value:!0});I.ai=void 0;var ve=4097,ge=4,ye=.8,me=ve*ge*ye;function _e({name:e,prompt:t,message:n,postProcess:i,temperature:r,splitOn:s}){return{scriptTimeout:15e3,custom:(a,c,u)=>he(this,void 0,void 0,function*(){var l,o;let f=yield c({command:"fig",args:["settings","--format","json","autocomplete.ai.enabled"]});if(!JSON.parse(f.stdout))return[];let g=typeof t=="function"?yield t({tokens:a,executeCommand:c,generatorContext:u}):t,S=typeof n=="function"?yield n({tokens:a,executeCommand:c,generatorContext:u}):n;if(S===null||S.length===0)return console.warn("No message provided to AI generator"),[];let p=me-((l=g?.length)!==null&&l!==void 0?l:0),v={model:"gpt-3.5-turbo",source:"autocomplete",name:e,messages:[...g?[{role:"system",content:g}]:[],{role:"user",content:S.slice(0,p)}],temperature:r},b=JSON.stringify(v),d=yield c({command:"fig",args:["_","request","--route","/ai/chat","--method","POST","--body",b]}),_=JSON.parse(d.stdout);return(o=_?.choices.map(h=>{var w;return(w=h?.message)===null||w===void 0?void 0:w.content}).filter(h=>typeof h=="string").flatMap(h=>s?h.split(s).filter(w=>w.trim().length>0):[h]).map(h=>{if(i)return i(h);let w=h.trim().replace(/\n/g," ");return{icon:"\u{1FA84}",name:w,insertValue:`'${w}'`,description:"Generated by Fig AI"}}))!==null&&o!==void 0?o:[]})}}I.ai=_e});var G=T(m=>{"use strict";var be=m&&m.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),Oe=m&&m.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&be(t,e,n)};Object.defineProperty(m,"__esModule",{value:!0});m.ai=m.folders=m.filepaths=void 0;var B=$();Object.defineProperty(m,"filepaths",{enumerable:!0,get:function(){return B.filepaths}});Object.defineProperty(m,"folders",{enumerable:!0,get:function(){return B.folders}});Oe(Q(),m);var Se=H();Object.defineProperty(m,"ai",{enumerable:!0,get:function(){return Se.ai}})});var U=re(G(),1),we={name:"Rscript",description:"Scripting Front-End for R",icon:"https://www.r-project.org/favicon-32x32.png",options:[{name:"-e",description:"R expression to run",isRepeatable:!0,args:{name:"expression",description:"R expression"}},{name:"--help",description:"Print usage and exit",icon:"\u2754"},{name:"--version",description:"Print version and exit"},{name:"--verbose",description:"Print information on progress",icon:"\u{1F4E3}"},{name:"--no-echo",description:"Run as quietly as possible",icon:"\u{1F64A}"},{name:"--no-restore",description:"Don't restore anything"},{name:"--save",description:"Do save workspace at the end of the session",icon:"\u{1F4BE}"},{name:"--no-environ",description:"Don't read the site and user environment files"},{name:"--no-site-file",description:"Don't read the site-wide Rprofile"},{name:"--no-init-file",description:"Don't read the user R profile"},{name:"--restore",description:"Do restore previously saved objects at startup"},{name:"--vanilla",description:"Combine --no-save, --no-restore, --no-site-file --no-init-file and --no-environ"},{name:"--default-packages",description:"Comma separated list of default packages",requiresSeparator:!0,icon:"\u{1F4E6}",args:{name:"packages",description:"A comma-separated set of package names, or 'NULL'"}}],args:[{name:"file",description:"R script to run",isScript:!0,generators:(0,U.filepaths)({extensions:["R"],editFileSuggestions:{priority:76}})},{name:"args",description:"Arguments to pass to the script",isVariadic:!0}]},Fe=we;export{Fe as default};

var Y=Object.create;var $=Object.defineProperty;var ee=Object.getOwnPropertyDescriptor;var te=Object.getOwnPropertyNames;var ne=Object.getPrototypeOf,re=Object.prototype.hasOwnProperty;var T=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ie=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of te(t))!re.call(e,i)&&i!==n&&$(e,i,{get:()=>t[i],enumerable:!(r=ee(t,i))||r.enumerable});return e};var se=(e,t,n)=>(n=e!=null?Y(ne(e)):{},ie(t||!e||!e.__esModule?$(n,"default",{value:e,enumerable:!0}):n,e));var K=T(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.shellExpand=j.ensureTrailingSlash=void 0;var oe=e=>e.endsWith("/")?e:`${e}/`;j.ensureTrailingSlash=oe;var le=(e,t)=>e.startsWith("~")&&(e.length===1||e.charAt(1)==="/")?e.replace("~",t):e,ue=(e,t)=>e.replace(/\$([A-Za-z0-9_]+)/g,i=>{var s;let l=i.slice(1);return(s=t[l])!==null&&s!==void 0?s:i}).replace(/\$\{([A-Za-z0-9_]+)(?::-([^}]+))?\}/g,(i,s,l)=>{var c,a;return(a=(c=t[s])!==null&&c!==void 0?c:l)!==null&&a!==void 0?a:i}),ce=(e,t)=>{var n;let{environmentVariables:r}=t;return ue(le(e,(n=r?.HOME)!==null&&n!==void 0?n:"~"),r)};j.shellExpand=ce});var J=T(y=>{"use strict";var ae=y&&y.__awaiter||function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(o){try{u(r.next(o))}catch(f){l(f)}}function a(o){try{u(r.throw(o))}catch(f){l(f)}}function u(o){o.done?s(o.value):i(o.value).then(c,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(y,"__esModule",{value:!0});y.filepaths=y.folders=y.getCurrentInsertedDirectory=y.sortFilesAlphabetically=void 0;var C=K();function z(e,t=[]){let n=t.map(i=>i.toLowerCase()),r=e.filter(i=>!n.includes(i.toLowerCase()));return[...r.filter(i=>!i.startsWith(".")).sort((i,s)=>i.localeCompare(s)),...r.filter(i=>i.startsWith(".")).sort((i,s)=>i.localeCompare(s)),"../"]}y.sortFilesAlphabetically=z;var fe=(e,t,n)=>{if(e===null)return"/";let r=(0,C.shellExpand)(t,n),i=r.slice(0,r.lastIndexOf("/")+1);return i===""?(0,C.ensureTrailingSlash)(e):i.startsWith("/")?i:`${(0,C.ensureTrailingSlash)(e)}${i}`};y.getCurrentInsertedDirectory=fe;function L(e={}){let{extensions:t=[],equals:n=[],matches:r,filterFolders:i=!1,editFileSuggestions:s,editFolderSuggestions:l,rootDirectory:c,showFolders:a="always"}=e,u=new Set(t),o=new Set(n),f=()=>t.length>0||n.length>0||r,v=(h=[])=>f()?h.filter(({name:g="",type:O})=>{if(!i&&O==="folder"||o.has(g)||r&&g.match(r))return!0;let[,...d]=g.split(".");if(d.length>=1){let m=d.length-1,b=d[m];do{if(u.has(b))return!0;m-=1,b=[d[m],b].join(".")}while(m>=0)}return!1}):h,S=(h=[])=>!s&&!l?h:h.map(g=>Object.assign(Object.assign({},g),(g.type==="file"?s:l)||{}));return{trigger:(h,g)=>{let O=h.lastIndexOf("/"),d=g.lastIndexOf("/");return O!==d?!0:O===-1&&d===-1?!1:h.slice(0,O)!==g.slice(0,d)},getQueryTerm:h=>h.slice(h.lastIndexOf("/")+1),custom:(h,g,O)=>ae(this,void 0,void 0,function*(){var d;let{isDangerous:m,currentWorkingDirectory:b,searchTerm:p}=O,w=(d=(0,y.getCurrentInsertedDirectory)(c??b,p,O))!==null&&d!==void 0?d:"/";try{let N=yield g({command:"ls",args:["-1ApL"],cwd:w}),U=z(N.stdout.split(`
`),[".DS_Store"]),W=[];for(let F of U)if(F){let V=F.endsWith("/")?"folders":"filepaths";(V==="filepaths"&&a!=="only"||V==="folders"&&a!=="never")&&W.push({type:V==="filepaths"?"file":"folder",name:F,insertValue:F,isDangerous:m,context:{templateType:V}})}return S(v(W))}catch{return[]}})}}y.folders=Object.assign(()=>L({showFolders:"only"}),Object.freeze(L({showFolders:"only"})));y.filepaths=Object.assign(L,Object.freeze(L()))});var B=T(x=>{"use strict";var A=x&&x.__awaiter||function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(o){try{u(r.next(o))}catch(f){l(f)}}function a(o){try{u(r.throw(o))}catch(f){l(f)}}function u(o){o.done?s(o.value):i(o.value).then(c,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(x,"__esModule",{value:!0});x.keyValueList=x.keyValue=x.valueList=void 0;var Q=new Map;function D(e,t){return e.length===0?t:t.map(n=>n.insertValue?n:Object.assign(Object.assign({},n),{insertValue:n.name+e}))}function H(e,t,n){return A(this,void 0,void 0,function*(){if(typeof e=="function"){let r=yield e(...n);return D(t,r)}if(typeof e[0]=="string"){let r=e.map(i=>({name:i}));return D(t,r)}return D(t,e)})}function E(e,t,n,r){return A(this,void 0,void 0,function*(){if(n||Array.isArray(e)){let i=Q.get(e);return i===void 0&&(i=yield H(e,t,r),Q.set(e,i)),i}return H(e,t,r)})}function k(e,t){return typeof t=="string"?e&&t==="keys"||!e&&t==="values":t}function M(e,...t){return Math.max(...t.map(n=>e.lastIndexOf(n)))}function P(e,t){let n=new Set(e);return t.filter(r=>{var i;return typeof r.name=="string"?!n.has(r.name):!(!((i=r.name)===null||i===void 0)&&i.some(s=>n.has(s)))})}function de({delimiter:e=",",values:t=[],cache:n=!1,insertDelimiter:r=!1,allowRepeatedValues:i=!1}){return{trigger:(s,l)=>s.lastIndexOf(e)!==l.lastIndexOf(e),getQueryTerm:s=>s.slice(s.lastIndexOf(e)+e.length),custom:(...s)=>A(this,void 0,void 0,function*(){var l;let c=yield E(t,r?e:"",n,s);if(i)return c;let[a]=s,u=(l=a[a.length-1])===null||l===void 0?void 0:l.split(e);return P(u,c)})}}x.valueList=de;function he({separator:e="=",keys:t=[],values:n=[],cache:r=!1,insertSeparator:i=!0}){return{trigger:(s,l)=>s.indexOf(e)!==l.indexOf(e),getQueryTerm:s=>s.slice(s.indexOf(e)+1),custom:(...s)=>A(this,void 0,void 0,function*(){let[l]=s,a=!l[l.length-1].includes(e),u=a?t:n,o=k(a,r);return E(u,a&&i?e:"",o,s)})}}x.keyValue=he;function pe({separator:e="=",delimiter:t=",",keys:n=[],values:r=[],cache:i=!1,insertSeparator:s=!0,insertDelimiter:l=!1,allowRepeatedKeys:c=!1,allowRepeatedValues:a=!0}){return{trigger:(u,o)=>{let f=M(u,e,t),v=M(o,e,t);return f!==v},getQueryTerm:u=>{let o=M(u,e,t);return u.slice(o+1)},custom:(...u)=>A(this,void 0,void 0,function*(){let[o]=u,f=o[o.length-1],v=M(f,e,t),S=v===-1||f.slice(v,v+e.length)!==e,h=S?n:r,g=k(S,i),d=yield E(h,S?s?e:"":l?t:"",g,u);if(S){if(c)return d;let b=f.split(t).map(p=>p.slice(0,p.indexOf(e)));return P(b,d)}if(a)return d;let m=f.split(t).map(b=>b.slice(b.indexOf(e)+e.length));return P(m,d)})}}x.keyValueList=pe});var G=T(I=>{"use strict";var ge=I&&I.__awaiter||function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(o){try{u(r.next(o))}catch(f){l(f)}}function a(o){try{u(r.throw(o))}catch(f){l(f)}}function u(o){o.done?s(o.value):i(o.value).then(c,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(I,"__esModule",{value:!0});I.ai=void 0;var ve=4097,ye=4,_e=.8,me=ve*ye*_e;function Oe({name:e,prompt:t,message:n,postProcess:r,temperature:i,splitOn:s}){return{scriptTimeout:15e3,custom:(l,c,a)=>ge(this,void 0,void 0,function*(){var u,o;let f=yield c({command:"fig",args:["settings","--format","json","autocomplete.ai.enabled"]});if(!JSON.parse(f.stdout))return[];let v=typeof t=="function"?yield t({tokens:l,executeCommand:c,generatorContext:a}):t,S=typeof n=="function"?yield n({tokens:l,executeCommand:c,generatorContext:a}):n;if(S===null||S.length===0)return console.warn("No message provided to AI generator"),[];let h=me-((u=v?.length)!==null&&u!==void 0?u:0),g={model:"gpt-3.5-turbo",source:"autocomplete",name:e,messages:[...v?[{role:"system",content:v}]:[],{role:"user",content:S.slice(0,h)}],temperature:i},O=JSON.stringify(g),d=yield c({command:"fig",args:["_","request","--route","/ai/chat","--method","POST","--body",O]}),m=JSON.parse(d.stdout);return(o=m?.choices.map(p=>{var w;return(w=p?.message)===null||w===void 0?void 0:w.content}).filter(p=>typeof p=="string").flatMap(p=>s?p.split(s).filter(w=>w.trim().length>0):[p]).map(p=>{if(r)return r(p);let w=p.trim().replace(/\n/g," ");return{icon:"\u{1FA84}",name:w,insertValue:`'${w}'`,description:"Generated by Fig AI"}}))!==null&&o!==void 0?o:[]})}}I.ai=Oe});var Z=T(_=>{"use strict";var be=_&&_.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Se=_&&_.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&be(t,e,n)};Object.defineProperty(_,"__esModule",{value:!0});_.ai=_.folders=_.filepaths=void 0;var X=J();Object.defineProperty(_,"filepaths",{enumerable:!0,get:function(){return X.filepaths}});Object.defineProperty(_,"folders",{enumerable:!0,get:function(){return X.folders}});Se(B(),_);var we=G();Object.defineProperty(_,"ai",{enumerable:!0,get:function(){return we.ai}})});var R=se(Z(),1),q={name:"script path",isScript:!0,generators:(0,R.filepaths)({extensions:["ts"],editFileSuggestions:{priority:76},editFolderSuggestions:{priority:70}})},xe={name:"tsx",description:"Run TypeScript file using tsx",subcommands:[{name:"watch",description:"Run the script and watch for changes",args:q}],options:[{name:["--help","-h"],description:"Show help for tsx",isPersistent:!0},{name:"--no-cache",description:"Disable caching",isPersistent:!0},{name:"--clear-screen",description:"Disable clearing the screen on rerun",isPersistent:!0,insertValue:"--clear-screen=false",dependsOn:["watch"],args:q},{name:["-v","--version"],description:"Show version"},{name:"--tsconfig",description:"Custom tsconfig.json path",args:{name:"tsconfig.json path",generators:(0,R.filepaths)({extensions:["json"],editFileSuggestions:{priority:76},editFolderSuggestions:{priority:70}})}}],args:q},Le=xe;export{Le as default};

var ne=Object.create;var z=Object.defineProperty;var ie=Object.getOwnPropertyDescriptor;var re=Object.getOwnPropertyNames;var oe=Object.getPrototypeOf,se=Object.prototype.hasOwnProperty;var j=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var le=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of re(t))!se.call(e,r)&&r!==n&&z(e,r,{get:()=>t[r],enumerable:!(i=ie(t,r))||i.enumerable});return e};var ae=(e,t,n)=>(n=e!=null?ne(oe(e)):{},le(t||!e||!e.__esModule?z(n,"default",{value:e,enumerable:!0}):n,e));var J=j(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.shellExpand=x.ensureTrailingSlash=void 0;var ue=e=>e.endsWith("/")?e:`${e}/`;x.ensureTrailingSlash=ue;var ce=(e,t)=>e.startsWith("~")&&(e.length===1||e.charAt(1)==="/")?e.replace("~",t):e,de=(e,t)=>e.replace(/\$([A-Za-z0-9_]+)/g,r=>{var o;let l=r.slice(1);return(o=t[l])!==null&&o!==void 0?o:r}).replace(/\$\{([A-Za-z0-9_]+)(?::-([^}]+))?\}/g,(r,o,l)=>{var u,c;return(c=(u=t[o])!==null&&u!==void 0?u:l)!==null&&c!==void 0?c:r}),fe=(e,t)=>{var n;let{environmentVariables:i}=t;return de(ce(e,(n=i?.HOME)!==null&&n!==void 0?n:"~"),i)};x.shellExpand=fe});var k=j(y=>{"use strict";var pe=y&&y.__awaiter||function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(l){l(o)})}return new(n||(n=Promise))(function(o,l){function u(s){try{a(i.next(s))}catch(d){l(d)}}function c(s){try{a(i.throw(s))}catch(d){l(d)}}function a(s){s.done?o(s.value):r(s.value).then(u,c)}a((i=i.apply(e,t||[])).next())})};Object.defineProperty(y,"__esModule",{value:!0});y.filepaths=y.folders=y.getCurrentInsertedDirectory=y.sortFilesAlphabetically=void 0;var C=J();function Q(e,t=[]){let n=t.map(r=>r.toLowerCase()),i=e.filter(r=>!n.includes(r.toLowerCase()));return[...i.filter(r=>!r.startsWith(".")).sort((r,o)=>r.localeCompare(o)),...i.filter(r=>r.startsWith(".")).sort((r,o)=>r.localeCompare(o)),"../"]}y.sortFilesAlphabetically=Q;var ve=(e,t,n)=>{if(e===null)return"/";let i=(0,C.shellExpand)(t,n),r=i.slice(0,i.lastIndexOf("/")+1);return r===""?(0,C.ensureTrailingSlash)(e):r.startsWith("/")?r:`${(0,C.ensureTrailingSlash)(e)}${r}`};y.getCurrentInsertedDirectory=ve;function D(e={}){let{extensions:t=[],equals:n=[],matches:i,filterFolders:r=!1,editFileSuggestions:o,editFolderSuggestions:l,rootDirectory:u,showFolders:c="always"}=e,a=new Set(t),s=new Set(n),d=()=>t.length>0||n.length>0||i,g=(p=[])=>d()?p.filter(({name:h="",type:_})=>{if(!r&&_==="folder"||s.has(h)||i&&h.match(i))return!0;let[,...f]=h.split(".");if(f.length>=1){let O=f.length-1,b=f[O];do{if(a.has(b))return!0;O-=1,b=[f[O],b].join(".")}while(O>=0)}return!1}):p,S=(p=[])=>!o&&!l?p:p.map(h=>Object.assign(Object.assign({},h),(h.type==="file"?o:l)||{}));return{trigger:(p,h)=>{let _=p.lastIndexOf("/"),f=h.lastIndexOf("/");return _!==f?!0:_===-1&&f===-1?!1:p.slice(0,_)!==h.slice(0,f)},getQueryTerm:p=>p.slice(p.lastIndexOf("/")+1),custom:(p,h,_)=>pe(this,void 0,void 0,function*(){var f;let{isDangerous:O,currentWorkingDirectory:b,searchTerm:v}=_,w=(f=(0,y.getCurrentInsertedDirectory)(u??b,v,_))!==null&&f!==void 0?f:"/";try{let $=yield h({command:"ls",args:["-1ApL"],cwd:w}),te=Q($.stdout.split(`
`),[".DS_Store"]),K=[];for(let E of te)if(E){let M=E.endsWith("/")?"folders":"filepaths";(M==="filepaths"&&c!=="only"||M==="folders"&&c!=="never")&&K.push({type:M==="filepaths"?"file":"folder",name:E,insertValue:E,isDangerous:O,context:{templateType:M}})}return S(g(K))}catch{return[]}})}}y.folders=Object.assign(()=>D({showFolders:"only"}),Object.freeze(D({showFolders:"only"})));y.filepaths=Object.assign(D,Object.freeze(D()))});var B=j(T=>{"use strict";var V=T&&T.__awaiter||function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(l){l(o)})}return new(n||(n=Promise))(function(o,l){function u(s){try{a(i.next(s))}catch(d){l(d)}}function c(s){try{a(i.throw(s))}catch(d){l(d)}}function a(s){s.done?o(s.value):r(s.value).then(u,c)}a((i=i.apply(e,t||[])).next())})};Object.defineProperty(T,"__esModule",{value:!0});T.keyValueList=T.keyValue=T.valueList=void 0;var G=new Map;function P(e,t){return e.length===0?t:t.map(n=>n.insertValue?n:Object.assign(Object.assign({},n),{insertValue:n.name+e}))}function H(e,t,n){return V(this,void 0,void 0,function*(){if(typeof e=="function"){let i=yield e(...n);return P(t,i)}if(typeof e[0]=="string"){let i=e.map(r=>({name:r}));return P(t,i)}return P(t,e)})}function R(e,t,n,i){return V(this,void 0,void 0,function*(){if(n||Array.isArray(e)){let r=G.get(e);return r===void 0&&(r=yield H(e,t,i),G.set(e,r)),r}return H(e,t,i)})}function U(e,t){return typeof t=="string"?e&&t==="keys"||!e&&t==="values":t}function L(e,...t){return Math.max(...t.map(n=>e.lastIndexOf(n)))}function q(e,t){let n=new Set(e);return t.filter(i=>{var r;return typeof i.name=="string"?!n.has(i.name):!(!((r=i.name)===null||r===void 0)&&r.some(o=>n.has(o)))})}function he({delimiter:e=",",values:t=[],cache:n=!1,insertDelimiter:i=!1,allowRepeatedValues:r=!1}){return{trigger:(o,l)=>o.lastIndexOf(e)!==l.lastIndexOf(e),getQueryTerm:o=>o.slice(o.lastIndexOf(e)+e.length),custom:(...o)=>V(this,void 0,void 0,function*(){var l;let u=yield R(t,i?e:"",n,o);if(r)return u;let[c]=o,a=(l=c[c.length-1])===null||l===void 0?void 0:l.split(e);return q(a,u)})}}T.valueList=he;function ge({separator:e="=",keys:t=[],values:n=[],cache:i=!1,insertSeparator:r=!0}){return{trigger:(o,l)=>o.indexOf(e)!==l.indexOf(e),getQueryTerm:o=>o.slice(o.indexOf(e)+1),custom:(...o)=>V(this,void 0,void 0,function*(){let[l]=o,c=!l[l.length-1].includes(e),a=c?t:n,s=U(c,i);return R(a,c&&r?e:"",s,o)})}}T.keyValue=ge;function ye({separator:e="=",delimiter:t=",",keys:n=[],values:i=[],cache:r=!1,insertSeparator:o=!0,insertDelimiter:l=!1,allowRepeatedKeys:u=!1,allowRepeatedValues:c=!0}){return{trigger:(a,s)=>{let d=L(a,e,t),g=L(s,e,t);return d!==g},getQueryTerm:a=>{let s=L(a,e,t);return a.slice(s+1)},custom:(...a)=>V(this,void 0,void 0,function*(){let[s]=a,d=s[s.length-1],g=L(d,e,t),S=g===-1||d.slice(g,g+e.length)!==e,p=S?n:i,h=U(S,r),f=yield R(p,S?o?e:"":l?t:"",h,a);if(S){if(u)return f;let b=d.split(t).map(v=>v.slice(0,v.indexOf(e)));return q(b,f)}if(c)return f;let O=d.split(t).map(b=>b.slice(b.indexOf(e)+e.length));return q(O,f)})}}T.keyValueList=ye});var X=j(A=>{"use strict";var me=A&&A.__awaiter||function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(l){l(o)})}return new(n||(n=Promise))(function(o,l){function u(s){try{a(i.next(s))}catch(d){l(d)}}function c(s){try{a(i.throw(s))}catch(d){l(d)}}function a(s){s.done?o(s.value):r(s.value).then(u,c)}a((i=i.apply(e,t||[])).next())})};Object.defineProperty(A,"__esModule",{value:!0});A.ai=void 0;var Oe=4097,_e=4,be=.8,Se=Oe*_e*be;function we({name:e,prompt:t,message:n,postProcess:i,temperature:r,splitOn:o}){return{scriptTimeout:15e3,custom:(l,u,c)=>me(this,void 0,void 0,function*(){var a,s;let d=yield u({command:"fig",args:["settings","--format","json","autocomplete.ai.enabled"]});if(!JSON.parse(d.stdout))return[];let g=typeof t=="function"?yield t({tokens:l,executeCommand:u,generatorContext:c}):t,S=typeof n=="function"?yield n({tokens:l,executeCommand:u,generatorContext:c}):n;if(S===null||S.length===0)return console.warn("No message provided to AI generator"),[];let p=Se-((a=g?.length)!==null&&a!==void 0?a:0),h={model:"gpt-3.5-turbo",source:"autocomplete",name:e,messages:[...g?[{role:"system",content:g}]:[],{role:"user",content:S.slice(0,p)}],temperature:r},_=JSON.stringify(h),f=yield u({command:"fig",args:["_","request","--route","/ai/chat","--method","POST","--body",_]}),O=JSON.parse(f.stdout);return(s=O?.choices.map(v=>{var w;return(w=v?.message)===null||w===void 0?void 0:w.content}).filter(v=>typeof v=="string").flatMap(v=>o?v.split(o).filter(w=>w.trim().length>0):[v]).map(v=>{if(i)return i(v);let w=v.trim().replace(/\n/g," ");return{icon:"\u{1FA84}",name:w,insertValue:`'${w}'`,description:"Generated by Fig AI"}}))!==null&&s!==void 0?s:[]})}}A.ai=we});var Y=j(m=>{"use strict";var Te=m&&m.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),Ie=m&&m.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&Te(t,e,n)};Object.defineProperty(m,"__esModule",{value:!0});m.ai=m.folders=m.filepaths=void 0;var Z=k();Object.defineProperty(m,"filepaths",{enumerable:!0,get:function(){return Z.filepaths}});Object.defineProperty(m,"folders",{enumerable:!0,get:function(){return Z.folders}});Ie(B(),m);var xe=X();Object.defineProperty(m,"ai",{enumerable:!0,get:function(){return xe.ai}})});var ee=ae(Y(),1),I={name:["--yes","-y"],description:"Automatic yes to prompts. Assume yes to all prompts and run non-interactively"},F={name:["-m","--dotenvMe"],description:"Pass .env.me (DOTENV_ME) credential directly (rather than reading from .env.me file)",args:{name:"DOTENV_ME",description:"Pass .env.me (DOTENV_ME) credential directly"}},Ae={name:"DOTENV_VAULT",description:"Set .env.vault identifier. Defaults to generated value",isOptional:!0},je={name:"DOTENV_ME",description:"Set .env.me credential. Defaults to generated value",isOptional:!0},N={name:"ENVIRONMENT",description:"Set environment to open to. Defaults to development",isOptional:!0},W={name:"FILENAME",description:"Set input filename. Defaults to .env for development and .env.{environment} for other environments",isOptional:!0,generators:(0,ee.filepaths)({matches:/^\.env.*$/})},Ve={name:"dotenv-vault",description:"CLI for dotenv-vault",options:[{name:"--help",description:"Get documentation for the command",isPersistent:!0}],subcommands:[{name:"new",description:"Create your project",options:[I],args:Ae},{name:"login",description:"Log in to dotenv-vault",options:[I],args:je},{name:"logout",description:"Log out from dotenv-vault",options:[I]},{name:"open",description:"Opens project page in a browser",options:[I],args:N},{name:"push",description:"Push .env securely",options:[I,F],args:[N,W]},{name:"pull",description:"Pull .env securely",options:[I,F],args:[N,W]},{name:"versions",description:"List version history",options:[I,F],args:[N,W]},{name:"whoami",description:"Display the current logged in user",options:[F]},{name:"status",description:"Check dotenv-operational status",options:[I]},{name:"help",description:"Display help for dotenv-vault"},{name:"update",description:"Update the dotenv-vault CLI",options:[I]}]},Ce=Ve;export{Ce as default};
